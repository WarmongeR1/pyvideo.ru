language: python
python:
  - 3.4
install:
  - pip install -r requirements.txt
script:
  - coverage run --source=sergey,proposal manage.py test
  - python manage.py syncdb --noinput
  - python manage.py migrate --noinput
  - python manage.py review
after_success:
  - coveralls
deploy:
  provider: heroku
  api_key:
    secure: hljuMQzAgAqEJgLbrBFGVbdLuvfgeNi8ke4BYygB2jA2eCW8GnnI0EhsEnZI1VobOOi1M3DYzG40XXbZmNxA2hslmQvwnMLmyt+Cc+nbDIUOsNasoYs1lIhytVckUqYgrrojbM4iSVm4YsGye76TTDa+CI6w7GqBm/B57KSSCqo=
  app: pyvideoru
  on:
    repo: coagulant/pyvideo.ru
  run:
    - "python manage.py migrate --noinput"
    - "python manage.py review"
    - "python manage.py embed"
    - restart
